<!DOCTYPE html>
<html lang="es">
<head>
  <script src="https://unpkg.com/@tonconnect/ui@latest/dist/tonconnect-ui.min.js"></script>
  <meta charset="UTF-8">
  <title>TapQuest â€“ Reinos de TON</title>
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <link rel="stylesheet" href="style.css">
</head>

<body>

<!-- MENU -->
<div id="menu" class="screen show">
  <h1>âš”ï¸ TapQuest</h1>
  <button class="play" id="connectBtn">ğŸ”— Conectar Wallet</button>
<div id="walletAddress"></div>
  <button onclick="claimReward()">ğŸ’° Reclamar TapCoin</button>

  <div class="card">
    Nivel: <span id="level">1</span><br>
    XP: <span id="xp">0</span>/100<br>
    Zona: <span id="zoneName"></span><br>
    Arma: <span id="weaponName">Ninguna</span>
  </div>
  <div id="tq" style="margin:10px; font-size:18px;">
  $TQ: 0
  </div>

  <button class="play" id="playBtn">ğŸŒ Explorar</button>
  <button class="inv" id="invBtn">ğŸ’ Inventario</button>
</div>

<!-- GAME -->
<div id="game" class="screen">
  <h2 id="zoneTitle"></h2>

  <div class="bar">
    <div id="hpBar" class="fill hp"></div>
  </div>

  <div id="enemy" class="enemy">ğŸ‘¾</div>
  <div id="weapon" class="weapon">ğŸ—¡ï¸</div>
  <div id="weaponTimer" class="timer"></div>

  <button class="tap" id="attackBtn">âš”ï¸ ATACAR</button>
  <button class="back" id="backBtn">â¬…ï¸ Volver</button>
</div>

<!-- INVENTORY -->
<div id="inventory" class="screen">
  <h2>ğŸ’ Inventario</h2>
  <div id="items"></div>
  <button class="back" id="closeInvBtn">â¬…ï¸ Volver</button>
</div>

<script src="game.js"></script>
  <script>
/* =========================
   TAPQUEST â€“ TQ SYSTEM
   ========================= */

let tq = 0;

// Actualiza el texto en pantalla
function actualizarTQ() {
  const el = document.getElementById("tq");
  if (el) el.innerText = "$TQ: " + tq;
}

// Cuando el jugador gana TQ
function ganarTQ(cantidad = 1) {
  tq += cantidad;
  actualizarTQ();
}

// Enviar TQ al bot de Telegram
function enviarRecompensa(cantidad) {
  if (!window.Telegram || !Telegram.WebApp) {
    alert("Abre el juego desde Telegram");
    return;
  }

  Telegram.WebApp.sendData(JSON.stringify({
    type: "reward",
    amount: cantidad
  }));

  alert("Has enviado " + cantidad + " TQ al bot");
}

// BotÃ³n Reclamar TapCoin
function claimReward() {
  if (tq <= 0) {
    alert("No tienes TQ para reclamar");
    return;
  }

  enviarRecompensa(tq);
  tq = 0;
  actualizarTQ();
}

// Inicializar
document.addEventListener("DOMContentLoaded", actualizarTQ);
  </script>
</body>
</html>
