<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8">
  <title>TapQuest â€“ Reinos de TON</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <script src="https://telegram.org/js/telegram-web-app.js"></script>

  <style>
    body {
      margin: 0;
      font-family: Arial;
      background: linear-gradient(180deg,#0f2027,#203a43,#2c5364);
      color: white;
      text-align: center;
    }
    h1 { margin: 20px 0; }
    .card {
      background: rgba(0,0,0,.65);
      margin: 15px;
      padding: 20px;
      border-radius: 16px;
    }
    button {
      width: 90%;
      max-width: 320px;
      padding: 15px;
      margin: 8px auto;
      display: block;
      font-size: 18px;
      border-radius: 16px;
      border: none;
      cursor: pointer;
    }
    button:disabled {
      background: #555;
      color: #aaa;
    }
    .tap {
      background: gold;
      color: black;
      font-size: 22px;
      font-weight: bold;
    }
    .back { background: #444; color: white; }
    .hidden { display: none; }
  </style>
</head>

<body>

<h1>âš”ï¸ TapQuest</h1>

<!-- MAPA -->
<div class="card" id="map">
  <h2>ğŸ—ºï¸ Mapa del Mundo</h2>
  <p>ğŸ§¬ Nivel: <span id="level">1</span> | â­ XP: <span id="xp">0</span></p>

  <button onclick="enterZone(1)">ğŸŒ² Bosque Inicial</button>
  <button id="zone2" onclick="enterZone(2)" disabled>ğŸœï¸ Desierto (Nivel 3)</button>
  <button id="zone3" onclick="enterZone(3)" disabled>ğŸ”ï¸ MontaÃ±as (Nivel 5)</button>
</div>

<!-- ZONA -->
<div class="card hidden" id="zone">
  <h2 id="zoneName"></h2>

  <p>ğŸª™ Oro: <span id="gold">0</span></p>
  <p>ğŸ”‹ EnergÃ­a: <span id="energy">100</span></p>
  <p>â­ XP: <span id="xpZone">0</span></p>

  <p>ğŸ‘¹ Enemigo HP: <span id="enemy">0</span></p>

  <p id="missionText"></p>
  <p id="missionProgress"></p>

  <button class="tap" onclick="tap()">âš”ï¸ ATACAR</button>
  <button onclick="openInventory()">ğŸ’ Inventario</button>
  <button class="back" onclick="back()">â¬…ï¸ Volver</button>
</div>

<!-- INVENTARIO -->
<div class="card hidden" id="inventory">
  <h2>ğŸ’ Inventario</h2>

  <p>ğŸ—¡ï¸ Espadas: <span id="swords">0</span></p>
  <button onclick="useSword()">Usar espada</button>

  <p>ğŸ§ª Pociones: <span id="potions">0</span></p>
  <button onclick="usePotion()">Usar pociÃ³n</button>

  <button class="back" onclick="closeInventory()">â¬…ï¸ Volver</button>
</div>

<script>
/* ===== ESTADO ===== */
let gold = 0;
let energy = 100;
let level = 1;
let xp = 0;
let damage = 1;

/* INVENTARIO */
let inventory = { swords: 0, potions: 0 };

/* ZONAS */
const zones = {
  1: { name: "ğŸŒ² Bosque Inicial", hp: 5, xp: 5, gold: 2 },
  2: { name: "ğŸœï¸ Desierto Antiguo", hp: 10, xp: 10, gold: 4 },
  3: { name: "ğŸ”ï¸ MontaÃ±as Heladas", hp: 20, xp: 20, gold: 8 }
};

let currentZone = 1;
let enemyHP = zones[1].hp;

/* MISIÃ“N */
let mission = {
  goal: 3,
  progress: 0,
  completed: false
};

/* ===== MAPA ===== */
function enterZone(z) {
  currentZone = z;
  enemyHP = zones[z].hp;

  document.getElementById("map").classList.add("hidden");
  document.getElementById("zone").classList.remove("hidden");

  document.getElementById("zoneName").innerText = zones[z].name;
  updateUI();
}

function back() {
  document.getElementById("zone").classList.add("hidden");
  document.getElementById("map").classList.remove("hidden");
}

/* ===== COMBATE ===== */
function tap() {
  if (energy <= 0) return;

  energy--;
  enemyHP -= damage;

  if (enemyHP <= 0) {
    enemyHP = zones[currentZone].hp;
    gold += zones[currentZone].gold;
    xp += zones[currentZone].xp;
    mission.progress++;

    if (Math.random() < 0.3) inventory.potions++;
    if (Math.random() < 0.2) inventory.swords++;

    checkLevelUp();
  }

  updateUI();
}

/* ===== NIVEL ===== */
function checkLevelUp() {
  let need = level * 30;
  if (xp >= need) {
    xp -= need;
    level++;
    alert("ğŸ§¬ Subiste a nivel " + level);

    if (level >= 3) document.getElementById("zone2").disabled = false;
    if (level >= 5) document.getElementById("zone3").disabled = false;
  }
}

/* ===== INVENTARIO ===== */
function openInventory() {
  document.getElementById("zone").classList.add("hidden");
  document.getElementById("inventory").classList.remove("hidden");
  updateInventory();
}
function closeInventory() {
  document.getElementById("inventory").classList.add("hidden");
  document.getElementById("zone").classList.remove("hidden");
}
function useSword() {
  if (inventory.swords <= 0) return;
  inventory.swords--;
  damage++;
  alert("ğŸ—¡ï¸ DaÃ±o aumentado");
  updateInventory();
}
function usePotion() {
  if (inventory.potions <= 0) return;
  inventory.potions--;
  energy = Math.min(energy + 30, 100);
  updateUI();
  updateInventory();
}

/* ===== UI ===== */
function updateUI() {
  document.getElementById("gold").innerText = gold;
  document.getElementById("energy").innerText = energy;
  document.getElementById("enemy").innerText = enemyHP;
  document.getElementById("xp").innerText = xp;
  document.getElementById("xpZone").innerText = xp;
  document.getElementById("level").innerText = level;
}
function updateInventory() {
  document.getElementById("swords").innerText = inventory.swords;
  document.getElementById("potions").innerText = inventory.potions;
}

/* ===== IDLE ===== */
setInterval(() => {
  if (energy < 100) {
    energy++;
    updateUI();
  }
}, 5000);
</script>

</body>
</html>
